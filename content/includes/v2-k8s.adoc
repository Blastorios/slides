
[{invert}]
= Traefik With &#9096;

image::traefik-kubernetes-diagram.png["Traefik with Kubernetes Diagram",width=900]

[.small]
Diagram from link:https://medium.com/@geraldcroes[]

[.notes]
--
- How many ppl knows k8s in the room ?  Using it ? Using Traefik ?
- Traefik sticks under the hood to its model, but supports the k8s style of doing things by reading ingress ressources and
  its own CRD: ingress route.
--

== Ingress Example with &#9096;

[source,yaml]
----
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: corporate-webapp
  annotations:
    kubernetes.io/ingress.class: 'traefik'
spec:
  rules:
  - host: localhost
    http:
      paths:
      - backend:
          serviceName: corporate-webapp
          servicePort: 80
----

[.notes]
--
- Pretty limited
- Relies a lot on annotations to enable extended features
- Nobody is really happy with it.
--

== &#9096; Ingress Route (HTTP)

[source,yaml]
----
apiVersion: traefik.containo.us/v1alpha1
kind: IngressRoute
metadata:
  name: myapp
spec:
  entryPoints:
    - web
  routes:
  - match: Host(`localhost`) && PathPrefix(`/whoami`)
    kind: Rule
    services:
    - name: webapp
      port: 80
----

[.notes]
--
- Comes with a set of resources (Middlewares, TLSOption, TraefikService...)
--

== &#9096; Ingress Route (TCP)

[source,yaml]
----
apiVersion: traefik.containo.us/v1alpha1
kind: IngressRouteTCP
metadata:
  name: ingressroutetcpmongo.crd
spec:
  entryPoints:
    - mongotcp
  routes:
  - match: HostSNI(`mongo-prod`)
    services:
    - name: mongo-prod
      port: 27017
----
